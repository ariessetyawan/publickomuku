/**
 * KL_FontsManager_manageFontlist
 *
 *	@author: Katsulynx
 *  @last_edit:	06.07.2016
 *  @compiled:	06.07.2016 Google Closure Compiler
 */
var googleWebfonts,loadedFonts=[];function definePositions(){var b=1;$("#Sortable tr").each(function(a,d){var c=$(d).find("input.Position");parseInt(c.val())&&(c.val(b),b+=1)})}function hideHandle(b){$(b.toElement).toggleClass("fa-eye fa-eye-slash").parents(".dataRow").toggleClass("inactive");b=$(b.toElement).nextAll("input.Position");b.val(b.parents(".dataRow").hasClass("inactive")?0:1);definePositions()}
function toggleHandle(b){$(b.toElement).toggleClass("fa-toggle-on fa-toggle-off").parents(".dataRow").toggleClass("strikeThrough");b=$(b.toElement).nextAll("input.Active");b.val((parseInt(b.val())+1)%2)}
function googleFontSelection(b){b.preventDefault();googleWebfonts||$.ajax({url:"https://www.googleapis.com/webfonts/v1/webfonts?key="+webfonts_api_key,dataType:"json",async:!1,success:function(a){googleWebfonts=a.items}});XenForo.createOverlay(null,$("<div/>",{"class":"xenOverlay"}).append($("<div/>",{"class":"section"}).append($("<a/>",{"class":"close OverlayCloser"}),$("<h2/>",{"class":"heading",text:kl_phrases.select_webfont}),$("<div/>",{"class":"baseHtml"}).append($("<div/>",{id:"fontChoserWrapper"}).append($("<div/>").append($("<label/>").append($("<input/>",
{type:"checkbox","class":"FilterList",checked:"checked",value:"display"}),"Display"),$("<label/>").append($("<input/>",{type:"checkbox","class":"FilterList",checked:"checked",value:"serif"}),"Serif"),$("<label/>").append($("<input/>",{type:"checkbox","class":"FilterList",checked:"checked",value:"sans-serif"}),"Sans-Serif"),$("<label/>").append($("<input/>",{type:"checkbox","class":"FilterList",checked:"checked",value:"handwriting"}),"Handwriting"),$("<label/>").append($("<input/>",{type:"checkbox",
"class":"FilterList",checked:"checked",value:"monospace"}),"Monospace")),$("<select/>",{id:"fontChoser","class":"textCtrl"}).on("change",function(){var a=googleWebfonts[$(this).val()];$("#fontOptions h2").html(a.family).css("font-family",a.family);-1==$.inArray($(this).val(),loadedFonts)&&($("head").append('<link rel="stylesheet" href="https://fonts.googleapis.com/css?family='+a.family.replace(" ","+")+'"/>'),loadedFonts.push($(this).val()));$("#fontOptionSelector").empty();$("#fontOptionExample").css("font-family",
a.family);$.each(a.variants,function(a,b){$("#fontOptionSelector").append($("<label />").append($("<input/>",{type:"checkbox",name:"additionalOptions",value:b}),b))});$('#fontOptionSelector input[value="regular"]').attr("checked","checked")})),$("<div/>",{id:"fontOptions"}).append($("<h2/>",{text:googleWebfonts[0].family}),$("<fieldset/>",{id:"fontOptionSelector"}),$("<textarea/>",{id:"fontOptionExample","class":"textCtrl",text:"Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet."}).css("font-family",
googleWebfonts[0].family))),$("<div/>",{"class":"sectionFooter"}).append($("<button/>",{"class":"primary button OverlayCloser WebfontSelector",text:kl_phrases.select}).on("click",function(a){a=googleWebfonts[$("#fontChoser").val()].family;var d=[];$("#fontOptionSelector input").each(function(){$(this).attr("checked")&&d.push($(this).val())});var c="."+b.toElement.className.replace(/\s/g,".");$(c+" ~ input.family").val(a);$(c+" ~ input.data").val(JSON.stringify(d).replace('"regular','"400').replace('"italic',
'"400italic').replace('"bold','"400bold'));$(c+" ~ span").html(a).css("font-family",a);$(c).empty().addClass("fa fa-exchange").attr("aria-hidden",!0)})))),{noCache:!0}).load();$("#fontChoserWrapper > div > label > input").on("change",function(a){$("#fontChoser option").filter("."+$(this).val()).toggle()});$.each(googleWebfonts,function(a,b){$("#fontChoser").append('<option class="'+b.category+'" value="'+a+'">'+b.family+"</option>")});$("#fontChoser").attr("size",5).children().first().attr("selected",
"selected").css("font-family",googleWebfonts[0].family);loadedFonts.push("0");$("head").append('<link rel="stylesheet" href="https://fonts.googleapis.com/css?family='+googleWebfonts[0].family.replace(/\s/g,"+")+'"/>');$.each(googleWebfonts[0].variants,function(b,d){$("#fontOptionSelector").append($("<label />").append($("<input/>",{type:"checkbox",name:"additionalOptions",value:d}),d))});$("#fontOptionSelector input[value='regular']").attr("checked","checked")}
function fileUpload(b){var a=new FormData;b.currentTarget.files.length&&a.append("File",b.currentTarget.files[0]);a.append("_xfToken",$("input[name=_xfToken]").val());a.append("FileToDelete",$(b.currentTarget).parent().next().val());$(b.currentTarget).parents("td").find(".fileUpload span").html('<i class="fa fa-spinner fa-pulse"></i><span class="sr-only">Loading...</span>');$.ajax({url:"whatyouseewhatyouget.php?kl-fm/upload",type:"POST",data:a,cache:!1,processData:!1,contentType:!1,success:function(a,c,e){"undefined"===
typeof a.error?(a=JSON.parse($(a).find("#data").html()),a.files.length?$(b.currentTarget).parents("td").find(".fileUpload").next().val(a.files[0]).next().html(a.files[0]):$(b.currentTarget).parents("td").find(".fileUpload").next().val("").next().html(""),console.log(a),$(b.currentTarget).parents("td").find(".fileUpload span").html(kl_phrases.file_replace)):console.log("ERRORS: "+a.error)},error:function(a,c,e){console.log("ERRORS: "+c);$(b.currentTarget).parents("td").find(".fileUpload span").html(kl_phrases.file_upload)}})}
$(document).ready(function(){var b=1;$(".TypeSetting").on("click",function(a){a.preventDefault();a=$(this).data("type");var d="";switch(a){case "google":d=$("<span/>").append($("<button/>",{html:kl_phrases.select_webfont,"class":"button primary SelectFont button"+b}).on("click",function(a){googleFontSelection(a)}),$("<span/>",{"class":"muted",text:kl_phrases.no_selection}),$("<input/>",{type:"hidden","class":"family",name:"new["+b+"][family]"}),$("<input/>",{type:"hidden","class":"data",name:"new["+
b+"][additionalOptions]"}));break;case "local":d=$("<span/>").append($("<span/>",{"class":"button fileUpload"}).append($("<span/>",{text:kl_phrases.file_upload}),$("<input/>",{type:"file",name:"new["+b+"][file]",accept:".woff"}).on("change",function(a){fileUpload(a)})),$("<input/>",{"class":"DeleteOnUnload",type:"hidden",name:"new["+b+"][filename]"}),$("<span/>",{"class":"muted fileName"}));break;default:d=$("<input/>",{type:"text","class":"textCtrl",name:"new["+b+"][family]",placeholder:kl_phrases.font_stack})}a=
{firstChild:$("<td/>").append($("<input/>",{type:"hidden",class:'Position',name:"new["+b+"][position]",value:900+b}),$("<input/>",{type:"hidden",class:'Active',name:"new["+b+"][active]",value:1}),$("<i/>",{"class":"Tooltip fa fa-toggle-on ToggleHandle","aria-hidden":"true",title:kl_phrases.toggle_activity}).on("click",function(a){toggleHandle(a)})," ",$("<i/>",{"class":"Tooltip fa fa-eye HideHandle","aria-hidden":"true",title:kl_phrases.toggle_visibility}).on("click",function(a){hideHandle(a)})," ",$("<i/>",{"class":"Tooltip fa fa-bars SortHandle",
"aria-hidden":"true",title:kl_phrases.drag_and_sort})),secondChild:$("<td/>").append($("<input/>",{type:"text",name:"new["+b+"][title]","class":"fontTitle textCtrl",placeholder:kl_phrases.title})),thirdChild:$("<td/>").append(d),fourthChild:$("<td/>").append($("<span/>",{html:kl_phrases["type_"+a]}),$("<input/>",{type:"hidden",name:"new["+b+"][type]",value:a}))};var c=$("<tr>",{"class":"dataRow"});$.each(a,function(a,b){c.append(b)});$("#Sortable").append(c);b+=1});$(".DeleteHandle").not(".disabled").on("click",
function(a){$(this).toggleClass("active").parents(".dataRow").toggleClass("delete");a=$(this).nextAll("input.Delete");a.val(a.parents(".dataRow").hasClass("delete")?a.data("val"):0)});$(".HideHandle").on("click",function(a){hideHandle(a)});$(".ToggleHandle").on("click",function(a){toggleHandle(a)});$("#Sortable").sortable({handle:".SortHandle",items:"tr",helper:function(a,b){b.children().each(function(){$(this).width($(this).width())});return b},containment:"parent",axis:"y",cursor:"move",tolerance:"pointer"}).disableSelection().on("sortstop",
definePositions);$(".fontTitle").attr("disabled","disabled").addClass("noCtrl");$(".EditMode").click(function(a){a.preventDefault();XenForo.createOverlay(null,$("<div/>",{"class":"xenOverlay"}).append($("<div/>",{"class":"xenForm formOverlay"}).append($("<h2/>",{"class":"heading h1",text:kl_phrases.security_check}),$("<div/>",{"class":"ctrlUnit",html:kl_phrases.security_check_description}),$("<div/>",{"class":"ctrlUnit submitUnit"}).append($("<dt/>"),$("<dd/>").append($("<button/>",{"class":"primary button OverlayCloser EditModeTrigger",
text:kl_phrases.activate}).on("click",function(a){$(".fontTitle.change").removeAttr("disabled").removeClass("noCtrl");$(".DeleteHandle").addClass("visible");$(a.toElement).remove()}),$("<input/>",{"class":"button OverlayCloser",value:kl_phrases.cancel,type:"reset"}))))),{noCache:!0}).load()});$(".NewWebfont").on("click",function(a){a.preventDefault();$(".dataTable tbody").append($("<tr/>",{"class":"dataRow"}).append($("<td/>").append($("<i/>",{"class":"Tooltip fa fa-toggle-on ToggleHandle","aria-hidden":"true",
title:kl_phrases.toggle_activity}).on("click",function(a){toggleHandle(a)}),$("<input/>",{type:"hidden",name:"new["+b+"][active]",value:1,"class":"Active"})),$("<td/>").append($("<input/>",{type:"text","class":"textCtrl",name:"new["+b+"][title]",placeholder:kl_phrases.title}))));b+=1});$(".DescriptionUnhider").on("click",function(a){a.preventDefault();$(this).hide();$(".HiddenDescription").addClass("visible")})});