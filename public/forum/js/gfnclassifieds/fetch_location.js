/* 0bfe890ff68c17d3dfca46ada6f3f70a1ed3ee4e
 * Part of 'GoodForNothing Classifieds' for XenForo
 * Copyright © 2012-2016 GoodForNothing Labs
 * Licensed under GoodForNothing Labs' license agreement: https://gfnlabs.com/legal/license
 */
!function(c,b,a,d){if(typeof GFNClassifieds=="undefined"){GFNClassifieds={}}GFNClassifieds.LocationFetcher=function(n){var g={zoom:12,mapTypeControl:false,disableDoubleClickZoom:true,zoomControlOptions:true,streetViewControl:false,center:new google.maps.LatLng(n.data("latitude"),n.data("longitude"))},m=["route","neighborhood","sublocality_level_1","locality","administrative_area_level_2","administrative_area_level_1","country"],e=new google.maps.Map(a.getElementById("GoogleMap"),g),h=new google.maps.Geocoder(),i=new google.maps.Marker({position:e.getCenter(),draggable:true,map:e}),l=c(".LocationFinder"),f=n.siblings(".LocationSearch"),k=function(o){i.setPosition(o);e.panTo(o);l.find(".LocationInput").val("");l.find(".LatitudeInput").val(o.lat());l.find(".LongitudeInput").val(o.lng());var p=new google.maps.LatLng(o.lat(),o.lng());h.geocode({latLng:p},function(v,r){if(r==google.maps.GeocoderStatus.OK&&v[0]){var q=v[0]["address_components"];for(var u=0;u<q.length;u++){for(var t=0;t<m.length;t++){for(var s=0;s<q[u]["types"].length;s++){if(m[t]==q[u]["types"][s]){l.find('.LocationInput[data-name="'+m[t]+'"]').val(m[t]=="country"?q[u]["short_name"]:q[u]["long_name"])}}}}}else{XenForo.alert(XenForo.phrases.unable_to_fetch_location_data_from_google_maps_api,null,3000)}j()})},j=function(){var q="",p=false;OuterLoop:for(var o=0;o<m.length;o++){switch(m[o]){case"locality":case"administrative_area_level_1":continue OuterLoop}var r=l.find('.LocationInput[data-name="'+m[o]+'"]').val();if(!r){continue}if(p){q+=", "}else{p=true}q+=r}c(".CurrentLocation").text(q)};google.maps.event.addListener(e,"dblclick",function(o){k(o.latLng)});google.maps.event.addListener(i,"dragend",function(o){k(i.position)});f.bind("submit",function(p){p.preventDefault();var o=f.find(".textCtrl:text").val();if(!o){return}h.geocode({address:o},function(r,q){if(q==google.maps.GeocoderStatus.OK&&r){e.setZoom(16);k(r[0].geometry.location)}else{XenForo.alert(XenForo.phrases.unable_to_fetch_location_data_from_google_maps_api,null,3000)}})})};if(typeof google=="object"&&typeof google.maps=="object"){XenForo.register(".LocationFetcher","GFNClassifieds.LocationFetcher")}}(jQuery,this,document);